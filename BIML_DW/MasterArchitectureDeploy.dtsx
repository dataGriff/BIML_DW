<?xml version="1.0" encoding="utf-8"?>
<DTS:Executable DTS:CreationDate="06/25/2017 11:36:47" DTS:CreationName="Microsoft.Package" DTS:CreatorComputerName="GRIFF-PC" DTS:CreatorName="griff182uk" DTS:DTSID="{CB0D28DD-28CE-4F8A-A559-D4405E52FA78}" DTS:ExecutableType="Microsoft.Package" DTS:LastModifiedProductVersion="" DTS:LocaleID="2057" DTS:ObjectName="MasterArchitectureDeploy" DTS:refId="Package" DTS:VersionBuild="0" DTS:VersionGUID="{39789470-1766-4807-AA13-1C243BA9DF84}" DTS:VersionMajor="0" xmlns:DTS="www.microsoft.com/SqlServer/Dts">
  <DTS:Property DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager DTS:CreationName="OLEDB" DTS:DTSID="{E1308225-3336-4FF0-A83E-18DF592EC8ED}" DTS:ObjectName="Staging" DTS:refId="Package.ConnectionManagers[Staging]">
      <DTS:ObjectData>
        <DTS:ConnectionManager DTS:ConnectionString="server=GRIFF-PC\SQLEXPRESS2014;initial catalog=dw;provider=SQLNCLI11.1;integrated security=SSPI"></DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager DTS:CreationName="OLEDB" DTS:DTSID="{C99A37C9-37C2-4E31-B965-19163718B10B}" DTS:ObjectName="DataWarehouse" DTS:refId="Package.ConnectionManagers[DataWarehouse]">
      <DTS:ObjectData>
        <DTS:ConnectionManager DTS:ConnectionString="server=GRIFF-PC\SQLEXPRESS2014;initial catalog=dw;provider=SQLNCLI11.1;integrated security=SSPI"></DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Executables>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{C629BDE2-619D-4D91-8B03-D8C5A0C1642B}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Schema etl" DTS:refId="Package\SQL Create Schema etl" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="Staging" SQLTask:SqlStatementSource="&#xA;          CREATE SCHEMA etl&#xA;          AUTHORIZATION dbo;&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{7D990EFF-08FD-4071-848C-1E149C64D93A}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Schema import" DTS:refId="Package\SQL Create Schema import" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="DataWarehouse" SQLTask:SqlStatementSource="&#xA;          CREATE SCHEMA import&#xA;          AUTHORIZATION dbo;&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{5DDAFF9C-1834-4D32-B611-A39A50130EEB}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Stage PurchaseOrderDetail" DTS:refId="Package\SQL Create Stage PurchaseOrderDetail" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="Staging" SQLTask:SqlStatementSource="SET ANSI_NULLS ON&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;IF EXISTS (SELECT * from sys.objects WHERE object_id = OBJECT_ID(N'[stg].[PurchaseOrderDetail]') AND type IN (N'U'))&#xA;DROP TABLE [stg].[PurchaseOrderDetail]&#xA;GO&#xA;&#xA;CREATE TABLE [stg].[PurchaseOrderDetail]&#xA;(&#xA;-- Columns Definition&#xA; [PurchaseOrderID] int NOT NULL &#xA;, [PurchaseOrderDetailID] int IDENTITY(1,1) NOT NULL &#xA;, [DueDate] datetime NOT NULL &#xA;, [OrderQty] smallint NOT NULL &#xA;, [ProductID] int NOT NULL &#xA;, [UnitPrice] money NOT NULL &#xA;, [LineTotal] money NOT NULL &#xA;, [ReceivedQty] decimal(8,2) NOT NULL &#xA;, [RejectedQty] decimal(8,2) NOT NULL &#xA;, [StockedQty] decimal(9,2) NOT NULL &#xA;, [ModifiedDate] datetime NOT NULL &#xA;&#xA;-- Constraints&#xA;&#xA;)&#xA;ON &quot;default&quot;&#xA;WITH (DATA_COMPRESSION = NONE)&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;                EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Staging table for PurchaseOrderDetail information ready to transfer into data warehouse tables.' &#xA;                , @level0type=N'SCHEMA',@level0name=N'stg'&#xA;                , @level1type=N'TABLE'&#xA;                ,@level1name=N'PurchaseOrderDetail'&#xA;                GO&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{DECB0333-3477-49ED-825A-47C0BECA4791}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create DataWarehouse PurchaseOrderDetail" DTS:refId="Package\SQL Create DataWarehouse PurchaseOrderDetail" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="DataWarehouse" SQLTask:SqlStatementSource="SET ANSI_NULLS ON&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;IF EXISTS (SELECT * from sys.objects WHERE object_id = OBJECT_ID(N'[import].[PurchaseOrderDetail]') AND type IN (N'U'))&#xA;DROP TABLE [import].[PurchaseOrderDetail]&#xA;GO&#xA;&#xA;CREATE TABLE [import].[PurchaseOrderDetail]&#xA;(&#xA;-- Columns Definition&#xA; [PurchaseOrderID] int NOT NULL &#xA;, [PurchaseOrderDetailID] int IDENTITY(1,1) NOT NULL &#xA;, [DueDate] datetime NOT NULL &#xA;, [OrderQty] smallint NOT NULL &#xA;, [ProductID] int NOT NULL &#xA;, [UnitPrice] money NOT NULL &#xA;, [LineTotal] money NOT NULL &#xA;, [ReceivedQty] decimal(8,2) NOT NULL &#xA;, [RejectedQty] decimal(8,2) NOT NULL &#xA;, [StockedQty] decimal(9,2) NOT NULL &#xA;, [ModifiedDate] datetime NOT NULL &#xA;&#xA;-- Constraints&#xA;&#xA;)&#xA;ON &quot;default&quot;&#xA;WITH (DATA_COMPRESSION = NONE)&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;              &#xA;                        EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Data warehouse table holding PurchaseOrderDetail information that should not be accessed directly by end users.' &#xA;                , @level0type=N'SCHEMA',@level0name=N'import'&#xA;                , @level1type=N'TABLE'&#xA;                ,@level1name=N'PurchaseOrderDetail'&#xA;                GO&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{8A919C6A-E0A2-47EA-8294-565E00C5BD36}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Procedure PurchaseOrderDetail_MERGE" DTS:refId="Package\SQL Create Procedure PurchaseOrderDetail_MERGE" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="Staging" SQLTask:SqlStatementSource="&#xA;            &#xA;              &#xA;          IF OBJECT_ID('etl.PurchaseOrderDetail_MERGE') IS NOT NULL&#xA;            DROP PROCEDURE etl.PurchaseOrderDetail_MERGE;&#xA;          GO &#xA;          /*&#xA;          ############################&#xA;          Author: griff182uk&#xA;          Creation Date: 2017-06-25&#xA;          History:&#xA;          Example Usage: EXEC etl.PurchaseOrderDetail_MERGE;&#xA;          ############################&#xA;          */&#xA;          &#xA;          CREATE PROCEDURE etl.PurchaseOrderDetail_MERGE&#xA;          &#xA;          AS&#xA;          &#xA;          BEGIN TRY&#xA;          &#xA;          --Remove the error below once happy with your code&#xA;          DECLARE @msg NVARCHAR(MAX) = 'Awaiting Proper Code for MERGE. A basic starting point has been added but you want to check...'+CHAR(10)+&#xA;          +'Remove this error once you''re happy with the code.';&#xA;          RAISERROR (@msg,16,1);&#xA;          &#xA;          INSERT INTO import.PurchaseOrderDetail&#xA;          (&#xA;          [PurchaseOrderID], [PurchaseOrderDetailID], [DueDate], [OrderQty], [ProductID], [UnitPrice], [LineTotal], [ReceivedQty], [RejectedQty], [StockedQty], [ModifiedDate]&#xA;          )&#xA;          SELECT &#xA;          [PurchaseOrderID], [PurchaseOrderDetailID], [DueDate], [OrderQty], [ProductID], [UnitPrice], [LineTotal], [ReceivedQty], [RejectedQty], [StockedQty], [ModifiedDate]&#xA;          FROM stg.PurchaseOrderDetail&#xA;          &#xA;          END TRY&#xA;          &#xA;          BEGIN CATCH&#xA;          &#xA;          THROW;&#xA;          &#xA;          END CATCH&#xA;          &#xA;          GO &#xA;          &#xA;          EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Merges data from stage PurchaseOrderDetail into data warehouse PurchaseOrderDetail' &#xA;                , @level0type=N'SCHEMA',@level0name=N'etl'&#xA;                , @level1type=N'PROCEDURE'&#xA;                ,@level1name=N'PurchaseOrderDetail_MERGE'&#xA;                GO&#xA;          &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{C0931B2C-B592-4A76-BFB2-60960E81051E}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Stage SalesOrderDetail" DTS:refId="Package\SQL Create Stage SalesOrderDetail" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="Staging" SQLTask:SqlStatementSource="SET ANSI_NULLS ON&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;IF EXISTS (SELECT * from sys.objects WHERE object_id = OBJECT_ID(N'[stg].[SalesOrderDetail]') AND type IN (N'U'))&#xA;DROP TABLE [stg].[SalesOrderDetail]&#xA;GO&#xA;&#xA;CREATE TABLE [stg].[SalesOrderDetail]&#xA;(&#xA;-- Columns Definition&#xA; [SalesOrderID] int NOT NULL &#xA;, [SalesOrderDetailID] int IDENTITY(1,1) NOT NULL &#xA;, [CarrierTrackingNumber] nvarchar(25) &#xA;, [OrderQty] smallint NOT NULL &#xA;, [ProductID] int NOT NULL &#xA;, [SpecialOfferID] int NOT NULL &#xA;, [UnitPrice] money NOT NULL &#xA;, [UnitPriceDiscount] money NOT NULL &#xA;, [LineTotal] decimal(38,6) NOT NULL &#xA;, [rowguid] uniqueidentifier NOT NULL &#xA;, [ModifiedDate] datetime NOT NULL &#xA;&#xA;-- Constraints&#xA;&#xA;)&#xA;ON &quot;default&quot;&#xA;WITH (DATA_COMPRESSION = NONE)&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;                EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Staging table for SalesOrderDetail information ready to transfer into data warehouse tables.' &#xA;                , @level0type=N'SCHEMA',@level0name=N'stg'&#xA;                , @level1type=N'TABLE'&#xA;                ,@level1name=N'SalesOrderDetail'&#xA;                GO&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{B5B7BDB8-36B1-4811-B9A3-1CB64C07BA8B}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create DataWarehouse SalesOrderDetail" DTS:refId="Package\SQL Create DataWarehouse SalesOrderDetail" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="DataWarehouse" SQLTask:SqlStatementSource="SET ANSI_NULLS ON&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;IF EXISTS (SELECT * from sys.objects WHERE object_id = OBJECT_ID(N'[import].[SalesOrderDetail]') AND type IN (N'U'))&#xA;DROP TABLE [import].[SalesOrderDetail]&#xA;GO&#xA;&#xA;CREATE TABLE [import].[SalesOrderDetail]&#xA;(&#xA;-- Columns Definition&#xA; [SalesOrderID] int NOT NULL &#xA;, [SalesOrderDetailID] int IDENTITY(1,1) NOT NULL &#xA;, [CarrierTrackingNumber] nvarchar(25) &#xA;, [OrderQty] smallint NOT NULL &#xA;, [ProductID] int NOT NULL &#xA;, [SpecialOfferID] int NOT NULL &#xA;, [UnitPrice] money NOT NULL &#xA;, [UnitPriceDiscount] money NOT NULL &#xA;, [LineTotal] decimal(38,6) NOT NULL &#xA;, [rowguid] uniqueidentifier NOT NULL &#xA;, [ModifiedDate] datetime NOT NULL &#xA;&#xA;-- Constraints&#xA;&#xA;)&#xA;ON &quot;default&quot;&#xA;WITH (DATA_COMPRESSION = NONE)&#xA;GO&#xA;&#xA;-------------------------------------------------------------------&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;              &#xA;                        EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Data warehouse table holding SalesOrderDetail information that should not be accessed directly by end users.' &#xA;                , @level0type=N'SCHEMA',@level0name=N'import'&#xA;                , @level1type=N'TABLE'&#xA;                ,@level1name=N'SalesOrderDetail'&#xA;                GO&#xA;              &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{AB5904A4-885F-4FA1-8781-7FD3EED88C0C}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Create Procedure SalesOrderDetail_MERGE" DTS:refId="Package\SQL Create Procedure SalesOrderDetail_MERGE" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="Staging" SQLTask:SqlStatementSource="&#xA;            &#xA;              &#xA;          IF OBJECT_ID('etl.SalesOrderDetail_MERGE') IS NOT NULL&#xA;            DROP PROCEDURE etl.SalesOrderDetail_MERGE;&#xA;          GO &#xA;          /*&#xA;          ############################&#xA;          Author: griff182uk&#xA;          Creation Date: 2017-06-25&#xA;          History:&#xA;          Example Usage: EXEC etl.SalesOrderDetail_MERGE;&#xA;          ############################&#xA;          */&#xA;          &#xA;          CREATE PROCEDURE etl.SalesOrderDetail_MERGE&#xA;          &#xA;          AS&#xA;          &#xA;          BEGIN TRY&#xA;          &#xA;          --Remove the error below once happy with your code&#xA;          DECLARE @msg NVARCHAR(MAX) = 'Awaiting Proper Code for MERGE. A basic starting point has been added but you want to check...'+CHAR(10)+&#xA;          +'Remove this error once you''re happy with the code.';&#xA;          RAISERROR (@msg,16,1);&#xA;          &#xA;          INSERT INTO import.SalesOrderDetail&#xA;          (&#xA;          [SalesOrderID], [SalesOrderDetailID], [CarrierTrackingNumber], [OrderQty], [ProductID], [SpecialOfferID], [UnitPrice], [UnitPriceDiscount], [LineTotal], [rowguid], [ModifiedDate]&#xA;          )&#xA;          SELECT &#xA;          [SalesOrderID], [SalesOrderDetailID], [CarrierTrackingNumber], [OrderQty], [ProductID], [SpecialOfferID], [UnitPrice], [UnitPriceDiscount], [LineTotal], [rowguid], [ModifiedDate]&#xA;          FROM stg.SalesOrderDetail&#xA;          &#xA;          END TRY&#xA;          &#xA;          BEGIN CATCH&#xA;          &#xA;          THROW;&#xA;          &#xA;          END CATCH&#xA;          &#xA;          GO &#xA;          &#xA;          EXEC sys.sp_addextendedproperty @name=N'Description'&#xA;                , @value=N'Merges data from stage SalesOrderDetail into data warehouse SalesOrderDetail' &#xA;                , @level0type=N'SCHEMA',@level0name=N'etl'&#xA;                , @level1type=N'PROCEDURE'&#xA;                ,@level1name=N'SalesOrderDetail_MERGE'&#xA;                GO&#xA;          &#xA;          " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"></SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
</DTS:Executable>